window.bootbox=window.bootbox||function a(b,c){"use strict";function d(a){var b=s[q.locale];return b?b[a]:s.en[a]}function e(a,c,d){a.preventDefault();var e=b.isFunction(d)&&d(a)===!1;e||c.modal("hide")}function f(a){var b,c=0;for(b in a)c++;return c}function g(a,c){var d=0;b.each(a,function(a,b){c(a,b,d++)})}function h(a){var c,d;if("object"!=typeof a)throw new Error("Please supply an object of options");if(!a.message)throw new Error("Please specify a message");return a=b.extend({},q,a),a.buttons||(a.buttons={}),a.backdrop=a.backdrop?"static":!1,c=a.buttons,d=f(c),g(c,function(a,e,f){if(b.isFunction(e)&&(e=c[a]={callback:e}),"object"!==b.type(e))throw new Error("button with key "+a+" must be an object");e.label||(e.label=a),e.className||(e.className=2>=d&&f===d-1?"btn-primary":"btn-default")}),a}function i(a,b){var c=a.length,d={};if(1>c||c>2)throw new Error("Invalid argument length");return 2===c||"string"==typeof a[0]?(d[b[0]]=a[0],d[b[1]]=a[1]):d=a[0],d}function j(a,c,d){return b.extend(!0,{},a,i(c,d))}function k(a,b,c){return n(j(m.apply(null,a),b,c),a)}function l(){for(var a={},b=0,c=arguments.length;c>b;b++){var e=arguments[b],f=e.toLowerCase(),g=e.toUpperCase();a[f]={label:d(g)}}return a}function m(){return{buttons:l.apply(null,arguments)}}function n(a,b){var d={};return g(b,function(a,b){d[b]=!0}),g(a.buttons,function(a){if(d[a]===c)throw new Error("button key "+a+" is not allowed (options are "+b.join("\n")+")")}),a}var o={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input form-control' autocomplete=off type=text />"}},p=b("body"),q={locale:"en",backdrop:!0,animate:!0,className:null,closeButton:!0,show:!0},r={};r.alert=function(){var a;if(a=k(["ok"],arguments,["message","callback"]),a.callback&&!b.isFunction(a.callback))throw new Error("alert requires callback property to be a function when provided");return a.buttons.ok.callback=a.onEscape=function(){return b.isFunction(a.callback)?a.callback():!0},r.dialog(a)},r.confirm=function(){var a;if(a=k(["cancel","confirm"],arguments,["message","callback"]),a.buttons.cancel.callback=a.onEscape=function(){return a.callback(!1)},a.buttons.confirm.callback=function(){return a.callback(!0)},!b.isFunction(a.callback))throw new Error("confirm requires a callback");return r.dialog(a)},r.prompt=function(){var a,d,e,f,g,h;if(f=b(o.form),d={buttons:l("cancel","confirm"),value:""},a=n(j(d,arguments,["title","callback"]),["cancel","confirm"]),h=a.show===c?!0:a.show,a.message=f,a.buttons.cancel.callback=a.onEscape=function(){return a.callback(null)},a.buttons.confirm.callback=function(){return a.callback(g.val())},a.show=!1,!a.title)throw new Error("prompt requires a title");if(!b.isFunction(a.callback))throw new Error("prompt requires a callback");return g=b(o.inputs.text),g.val(a.value),f.append(g),f.on("submit",function(a){a.preventDefault(),e.find(".btn-primary").click()}),e=r.dialog(a),e.off("shown.bs.modal"),e.on("shown.bs.modal",function(){g.focus()}),h===!0&&e.modal("show"),e},r.dialog=function(a){a=h(a);var c=b(o.dialog),d=c.find(".modal-body"),f=a.buttons,i="",j={onEscape:a.onEscape};if(g(f,function(a,b){i+="<button data-bb-handler='"+a+"' type='button' class='btn "+b.className+"'>"+b.label+"</button>",j[a]=b.callback}),d.find(".bootbox-body").html(a.message),a.animate===!0&&c.addClass("fade"),a.className&&c.addClass(a.className),a.title&&d.before(o.header),a.closeButton){var k=b(o.closeButton);a.title?c.find(".modal-header").prepend(k):k.css("margin-top","-10px").prependTo(d)}return a.title&&c.find(".modal-title").html(a.title),i.length&&(d.after(o.footer),c.find(".modal-footer").html(i)),c.on("hidden.bs.modal",function(a){a.target===this&&c.remove()}),c.on("shown.bs.modal",function(){c.find(".btn-primary:first").focus()}),c.on("escape.close.bb",function(a){j.onEscape&&e(a,c,j.onEscape)}),c.on("click",".modal-footer button",function(a){var d=b(this).data("bb-handler");e(a,c,j[d])}),c.on("click",".bootbox-close-button",function(a){e(a,c,j.onEscape)}),c.on("keyup",function(a){27===a.which&&c.trigger("escape.close.bb")}),p.append(c),c.modal({backdrop:a.backdrop,keyboard:!1,show:!1}),a.show&&c.modal("show"),c},r.setDefaults=function(a){b.extend(q,a)},r.hideAll=function(){b(".bootbox").modal("hide")};var s={br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierdź"},ru:{OK:"OK",CANCEL:"Отмена",CONFIRM:"Применить"},zh_CN:{OK:"OK",CANCEL:"取消",CONFIRM:"确认"},zh_TW:{OK:"OK",CANCEL:"取消",CONFIRM:"確認"}};return r.init=function(c){window.bootbox=a(c||b)},r}(window.jQuery),angular.module("LocalStorageModule").value("prefix","myDatabaseNewName"),angular.module("TickeyApp",["LocalStorageModule","firebase"]).config(["$routeProvider",function(a){a.when("/game_board",{templateUrl:"views/game_board.html",controller:"GameBoardCtrl"}).when("/game_board/:id/:mySymbol",{templateUrl:"views/game_board.html",controller:"GameBoardCtrl"}).when("/how_to",{templateUrl:"views/how_to.html",controller:"howToCtrl"}).when("/",{templateUrl:"views/index.html",controller:"indexCtrl"}).when("/MatchPlayer",{templateUrl:"views/MatchPlayer.html",controller:"MatchplayerCtrl"}).otherwise({redirection:"/"})}]),angular.module("TickeyApp").controller("GameBoardCtrl",["$scope","$rootScope","$timeout","localStorageService","angularFire","$routeParams","$location",function(a,b,c,d,e,f,g){function h(a,b){return!(b>a||a>b)}a.gameBoardId=f.id,a.mySymbol=f.mySymbol,a.oponentSymbol,a.cell=[],a.cellChanged,b.IsOnLineGame,a.room={board:["","","","","","","","","",""]},a.currentPlayer="start",a.myTurn=!1;var i=new Firebase("https://tictactoezam.firebaseio.com/room"+f.id);a.promise=e(i,a,"room"),a.promise.then(function(){return console.log("in promise"),f.id||"o"!=f.mySymbol&&"x"!=f.mySymbol||(bootbox.alert("you don't have any opponent, try again."),g.path("/")),f.id?(b.IsOnLineGame=!0,a.cleanBoard(),a.room.board=["","","","","","","","","",""],"x"==f.mySymbol?(console.log("I am First Move: Symbol: "+f.mySymbol),a.myTurn=!0):(console.log("I am Second Move: Symbol: "+f.mySymbol),a.myTurn=!1),void 0):(b.IsOnLineGame=!1,void 0)}),i.on("value",function(b){a.IsOnLineGame&&(a.myTurn||null!=b.val()&&(h(b.val().board,a.room.board)||(a.onLinePrintBoard(b.val()),a.onLineIsMeALoser()||(a.onLineIsDraw()?a.onLineDisplayDraw():(a.myTurn=!0,a.onLinePrintBoard(b.val()))))))}),a.onLinePlayerIs=function(){a.currentPlayer=a.mySymbol},a.OnlineMakeNextMoveAt=function(b){var d;if(a.cellObj=b,d=a.cellObj.target.id,!a.myTurn)return bootbox.alert("It's not your turn yet!"),void 0;if(!a.currentSquareClickedAlready(d)){if(a.onLineMarkSquareAsOccupiedAt(d),a.onLinePlayerIs(),a.myTurn=!1,a.isMeaWinner())return c(a.onLineGameOver,2e3),void 0;if(a.onLineIsDraw())return a.onLineDisplayDraw(),c(a.onLineGameOver,2e3),void 0}},a.onLineMarkSquareAsOccupiedAt=function(b){a.cell[b]=a.mySymbol,a.cellChanged++,a.room.board[b]=a.mySymbol},a.onLinePrintBoard=function(b){for(var c=1;c<=a.totalCellNumber;c++)b[c]!=a.cell[c]&&(a.cell[c]=b.board[c])},a.onLineIsMeALoser=function(){return a.oponentSymbol="x"==a.mySymbol?"o":"x",a.currentPlayer=a.oponentSymbol,a.IsOneLineCrossed()||a.IsOneColumnCrossed()||a.IsDiagonalCrossed()?(bootbox.alert("You lost! Try again!"),c(a.onLineGameOver,2e3),a.currentPlayer=start,!0):(a.currentPlayer="start",!1)},a.onLineIsDraw=function(){for(var b=0,c=1;c<=a.totalCellNumber;c++)("x"==a.cell[c]||"o"==a.cell[c])&&b++;return b==a.totalCellNumber?!0:!1},a.onLineDisplayDraw=function(){bootbox.alert("It's a draw, try again!"),c(a.onLineGameOver,2e3)},a.onLineGameOver=function(){c(a.onLineTimeoutDeleteRoomFirebase,5e3),a.cleanBoard(),a.currentPlayer="start",a.cellChanged=0,console.log("Game Over, play again!"),window.location.reload(!0)},a.onLineTimeoutDeleteRoomFirebase=function(){a.room={}},a.leaderData={users:{}};var j=new Firebase("https://tictactoezam.firebaseio.com/");a.p=e(j,a,"leaderData"),a.userCreatedInFirebase=!1,a.getName=function(){a.userName=prompt("What's your user name ?"),a.leaderData.users.hasOwnProperty(a.userName)?(alert(a.userName+", your previous score is : "+a.leaderData.users[a.userName]),1==a.playComputer&&(a.leaderData.users[a.userName]=a.leaderData.users[a.userName]+a.nbWin1)):a.p.then(function(){a.leaderData.users[a.userName]=0}),a.userCreatedInFirebase=!0},a.displayWinnerAgainComputerFireBase=function(){1==a.userCreatedInFirebase&&a.leaderData.users[a.userName]++},d.clearAll(),a.nbWin1=0,a.nbWin2=0,a.nbWinComputer=0,d.add("player2",a.nbWin2),d.add("computer",a.nbWinComputer),d.add("player1",a.nbWin1),a.minutes="00",a.seconds="05",a.currentNumberOfSeconds=5,a.intervalCallback,a.timerRunning=!1,a.increment=function(){return a.currentNumberOfSeconds--,a.currentNumberOfSeconds>0?(a.seconds=a.formatZeroPadding(a.currentNumberOfSeconds%60),a.intervalCallback=c(a.increment,1e3),void 0):(a.seconds=0,c.cancel(a.intervalCallback),a.stopTimer(),void 0)},a.startTimer=function(){a.timerRunning=!0,a.intervalCallback=c(a.increment,1e3)},a.stopTimer=function(){a.cleanTimer(),bootbox.alert("Time's up, try again!"),c(a.cleanBoard,1500)},a.cleanTimer=function(){a.timerRunning=!1,c.cancel(a.intervalCallback),a.currentNumberOfSeconds=5,a.seconds="05"},a.formatZeroPadding=function(a){return 10>a?"0"+a:a},b.is_how_to_page=!1,b.is_game_board_page_small_button=!0,b.is_home_page=!1,a.playComputer=!0,a.totalLine=3,a.totalColumn=3,a.totalCellbyLine=a.totalColumn,a.totalCellbyColumn=a.totalLine,a.lineBoard=[],a.totalCellNumber=a.totalLine*a.totalColumn,a.playerIs="start",a.cellObj,a.levelComputer=0,a.computerModeDescription=[],a.computerModeDescription[0]="Baby mode... sure you can win!",a.computerModeDescription[1]="Ninja mode... Not that easy!",a.computerModeDescription[2]="Guru mode... do your best!",a.switchPlayersMode=function(){"start"==a.currentPlayer&&(a.nbWin1=0,a.playComputer?(a.nbWin2=0,a.playComputer=!1):(a.nbWinComputer=0,a.playComputer=!0))},a.switchLevelMode=function(){"start"==a.currentPlayer&&(a.levelComputer++,a.levelComputer=a.levelComputer%3)},a.makeNextMoveAt=function(d){var e;a.cellObj=d,e=a.cellObj.target.id,1==b.IsOnLineGame?a.OnlineMakeNextMoveAt(d):("start"==a.currentPlayer&&a.initializePlayer(),a.currentSquareClickedAlready(e)||(a.markSquareAsOccupiedAt(e),a.isMeaWinner()||a.isDraw()||(a.swapCurrentPlayerToOpponent(),1==a.playComputer&&c(a.computerPlay,400))))},a.initializePlayer=function(){a.cleanBoard(),a.cellChanged=0,a.currentPlayer=1==Math.floor(2*Math.random()+1)?"x":"o",a.playerIs=a.currentPlayer},a.cleanBoard=function(){for(var b=1;b<=a.totalCellNumber;b++)a.cell[b]="";a.cellChanged=0,a.endOfGame()},a.currentSquareClickedAlready=function(b){return""!=a.cell[b]?!0:!1},a.markSquareAsOccupiedAt=function(b){a.cell[b]=a.currentPlayer,a.cellChanged++},a.swapCurrentPlayerToOpponent=function(){a.currentPlayer="x"==a.currentPlayer?"o":"x"},a.computerPlay=function(){0!=a.levelComputer?1==a.levelComputer?a.computerLevel1():a.computerLevel2():a.computerChooseCell(),a.isMeaWinner(),a.isDraw(),a.swapCurrentPlayerToOpponent()},a.computerChooseCell=function(){var b;b=Math.floor(9*Math.random()+1),""==a.cell[b]?a.markSquareAsOccupiedAt(b):a.computerChooseCell()},a.AddClassToCell=function(b){return""!=a.cell[b]?a.cell[b]:void 0},a.isDraw=function(){return a.cellChanged==a.totalCellNumber?(a.timerRunning&&a.cleanTimer(),bootbox.alert("It's a draw, try again!"),c(a.cleanBoard,2e3),!0):!1},a.isMeaWinner=function(){return a.IsOneLineCrossed()||a.IsOneColumnCrossed()||a.IsDiagonalCrossed()?(a.timerRunning&&a.cleanTimer(),b.IsOnLineGame?(bootbox.alert("You won!"),a.displayWinnerAgainComputerFireBase()):a.displayWinner(),!0):!1},a.IsOneLineCrossed=function(){for(var b=0;3>b;b++)if(a.cell[1+3*b]==a.currentPlayer&&a.cell[2+3*b]==a.currentPlayer&&a.cell[3+3*b]==a.currentPlayer)return!0;return!1},a.IsOneColumnCrossed=function(){for(var b=0;3>=b;b++)if(a.cell[1+b]==a.currentPlayer&&a.cell[4+b]==a.currentPlayer&&a.cell[7+b]==a.currentPlayer)return!0;return!1},a.IsDiagonalCrossed=function(){return a.cell[1]==a.currentPlayer&&a.cell[5]==a.currentPlayer&&a.cell[9]==a.currentPlayer||a.cell[3]==a.currentPlayer&&a.cell[5]==a.currentPlayer&&a.cell[7]==a.currentPlayer?!0:!1},a.addingScore=function(){return b.IsOnLineGame?(a.displayWinnerAgainComputerFireBase(),void 0):a.currentPlayer==a.playerIs?(a.nbWin1++,void 0):(a.playComputer?a.nbWinComputer++:a.nbWin2++,void 0)},a.displayWinner=function(){a.addingScore(),a.playComputer?a.currentPlayer==a.playerIs?(bootbox.alert("You beat the computer! Bravo"),a.displayWinnerAgainComputerFireBase()):bootbox.alert("You lost! Try again!"):"x"==a.currentPlayer?bootbox.alert("x wins! Bravo"):bootbox.alert("o wins! Bravo"),c(a.cleanBoard,2e3)},a.endOfGame=function(){a.currentPlayer="start",a.cellChanged=0},a.computerCheck3cells=function(b,c,d,e){return a.cell[b]!=e||a.cell[c]!=e||a.currentSquareClickedAlready(d)?a.cell[b]!=e||a.cell[d]!=e||a.currentSquareClickedAlready(c)?a.cell[c]!=e||a.cell[d]!=e||a.currentSquareClickedAlready(b)?!1:(a.markSquareAsOccupiedAt(b),!0):(a.markSquareAsOccupiedAt(c),!0):(a.markSquareAsOccupiedAt(d),!0)},a.computerCheckLine=function(b){for(var c=1;7>=c;c+=3)if(a.computerCheck3cells(c,c+1,c+2,b))return!0;return!1},a.computerCheckColumn=function(b){for(var c=1;3>=c;c++)if(a.computerCheck3cells(c,c+3,c+6,b))return!0;return!1},a.computerCheckDiagonal=function(b){return a.computerCheck3cells(1,5,9,b)?!0:a.computerCheck3cells(3,5,7,a.playerIs)?!0:void 0},a.computerLevel1=function(){a.computerCheckLine(a.playerIs)||a.computerCheckColumn(a.playerIs)||a.computerCheckDiagonal(a.playerIs)||a.computerChooseCell()},a.computerLevel2=function(){var b="x";"x"==a.playerIs&&(b="o"),a.computerCheckLine(b)||a.computerCheckColumn(b)||a.computerCheckDiagonal(b)||a.computerLevel1()}}]),angular.module("TickeyApp").controller("howToCtrl",["$scope","$rootScope",function(a,b){b.is_how_to_page=!0,b.is_game_board_page_small_button=!1,b.is_home_page=!1}]),angular.module("TickeyApp").controller("indexCtrl",["$scope","$rootScope",function(a,b){b.is_how_to_page=!1,b.is_game_board_page_small_button=!0,b.is_home_page=!0,b.IsOnLineGame=!1}]),angular.module("TickeyApp").directive("tickleMe",function(){return{restrict:"A",link:function(a,b){b.bind("click",function(){alert("Don't tickle me!")})}}}),angular.module("TickeyApp").directive("changeColor",function(){return{restrict:"A",link:function(a,b){b.bind("mouseenter",function(a){window.eventObj=a,a.target.className+=" changeColorGreen"}),b.bind("mouseleave",function(a){a.target.classList.remove("changeColorGreen")})}}}),angular.module("TickeyApp").filter("sortByScore",function(){return function(a){return"sortByScore filter: "+a}}),angular.module("TickeyApp").controller("MatchplayerCtrl",["$scope","angularFire","$location","$rootScope",function(a,b,c,d){function e(){return Math.floor(123444456*Math.random()).toString(16)}a.waitingRoom={};var f=new Firebase("https://tictactoezam.firebaseio.com/waitingRoom");a.promise=b(f,a,"waitingRoom"),d.IsOnLineGame=!1,a.promise.then(function(){1==a.waitingRoom.xJoined?a.joinWaitingRoom():a.createWaitingRoom()}),a.createWaitingRoom=function(){a.waitingRoom={xJoined:!0,gameBoardNumber:e()},a.noticeMessage="You are x, waiting for opponent",f.on("child_removed",function(){c.path("game_board/"+a.waitingRoom.gameBoardNumber+"/x")})},a.joinWaitingRoom=function(){var b=a.waitingRoom.gameBoardNumber;console.log("gameboard number : "+b),a.waitingRoom={},d.IsOnLineGame=!0,c.path("game_board/"+b+"/o")}}]);